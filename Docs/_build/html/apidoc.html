<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>API Reference &#8212; PaleoSTeHM 1.0.0-beta documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=3fd7a760"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="installation.html" />
    <link rel="prev" title="About" href="about.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="api-reference">
<span id="chapter-api-reference"></span><h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="paleostehm">
<h2>PaleoSTeHM<a class="headerlink" href="#paleostehm" title="Link to this heading">¶</a></h2>
<section id="module-PSTHM.kernels">
<span id="psthm-kernels-module"></span><h3>PSTHM.kernels module<a class="headerlink" href="#module-PSTHM.kernels" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.Combination">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">Combination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kern0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kern1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Combination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Combination" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Kernel</span></code></p>
<p>Base class for kernels derived from a combination of kernels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kern0</strong> (<em>Kernel</em>) – First kernel to combine.</p></li>
<li><p><strong>kern1</strong> (<em>Kernel</em><em> or </em><em>numbers.Number</em>) – Second kernel to combine.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.Combination.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.Combination.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.Constant">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">Constant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Constant"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Constant" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Kernel</span></code></p>
<p>Implementation of Constant kernel:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(k(x, z) = \sigma^2.\)</span></p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.Constant.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Constant.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Constant.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.Constant.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.Constant.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.Cosine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">Cosine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Cosine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Cosine" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PSTHM.kernels.Isotropy" title="PSTHM.kernels.Isotropy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Isotropy</span></code></a></p>
<p>Implementation of Cosine kernel:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(k(x,z) = \sigma^2 \cos\left(\frac{|x-z|}{l}\right).\)</span></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lengthscale</strong> (<em>torch.Tensor</em>) – Length-scale parameter of this kernel.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.Cosine.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Cosine.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Cosine.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.Cosine.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.Cosine.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.DotProduct">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">DotProduct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_year</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#DotProduct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.DotProduct" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Kernel</span></code></p>
<p>Base class for kernels which are functions of <span class="math notranslate nohighlight">\(x \cdot z\)</span>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.DotProduct.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.DotProduct.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.Exponential">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">Exponential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Exponential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Exponential" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PSTHM.kernels.Isotropy" title="PSTHM.kernels.Isotropy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Isotropy</span></code></a></p>
<p>Implementation of Exponential kernel:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(k(x, z) = \sigma^2\exp\left(-\frac{|x-z|}{l}\right).\)</span></p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.Exponential.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Exponential.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Exponential.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.Exponential.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.Exponential.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.Isotropy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">Isotropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Isotropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Isotropy" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Kernel</span></code></p>
<p>Base class for a family of isotropic covariance kernels which are functions of the
distance <span class="math notranslate nohighlight">\(|x-z|/l\)</span>, where <span class="math notranslate nohighlight">\(l\)</span> is the length-scale parameter.</p>
<p>By default, the parameter <code class="docutils literal notranslate"><span class="pre">lengthscale</span></code> has size 1. To use the isotropic version
(different lengthscale for each dimension), make sure that <code class="docutils literal notranslate"><span class="pre">lengthscale</span></code> has size
equal to <code class="docutils literal notranslate"><span class="pre">input_dim</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lengthscale</strong> (<em>torch.Tensor</em>) – Length-scale parameter of this kernel.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.Isotropy.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.Isotropy.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.Linear">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">Linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_year</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Linear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Linear" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PSTHM.kernels.DotProduct" title="PSTHM.kernels.DotProduct"><code class="xref py py-class docutils literal notranslate"><span class="pre">DotProduct</span></code></a></p>
<p>Implementation of Linear kernel:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(k(x, z) = \sigma^2 x \cdot z.\)</span></p>
</div></blockquote>
<p>Doing Gaussian Process regression with linear kernel is equivalent to doing a
linear regression.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here we implement the homogeneous version. To use the inhomogeneous
version, consider using <a class="reference internal" href="#PSTHM.kernels.Polynomial" title="PSTHM.kernels.Polynomial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polynomial</span></code></a> kernel with <code class="docutils literal notranslate"><span class="pre">degree=1</span></code> or making
a <a class="reference internal" href="#PSTHM.kernels.Sum" title="PSTHM.kernels.Sum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sum</span></code></a> with a <a class="reference internal" href="#PSTHM.kernels.Constant" title="PSTHM.kernels.Constant"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constant</span></code></a> kernel.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.Linear.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Linear.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Linear.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.Linear.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.Linear.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.Matern21">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">Matern21</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Matern21"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Matern21" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PSTHM.kernels.Isotropy" title="PSTHM.kernels.Isotropy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Isotropy</span></code></a></p>
<p>Implementation of Matern21 kernel:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(k(x, z) = \sigma^2\exp\left(- \frac{|x-z|}{l}\right).\)</span></p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.Matern21.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Matern21.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Matern21.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.Matern21.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.Matern21.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.Matern32">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">Matern32</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Matern32"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Matern32" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PSTHM.kernels.Isotropy" title="PSTHM.kernels.Isotropy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Isotropy</span></code></a></p>
<p>Implementation of Matern32 kernel:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(k(x, z) = \sigma^2\left(1 + \sqrt{3} \times \frac{|x-z|}{l}\right)
\exp\left(-\sqrt{3} \times \frac{|x-z|}{l}\right).\)</span></p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.Matern32.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Matern32.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Matern32.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.Matern32.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.Matern32.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.Matern52">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">Matern52</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Matern52"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Matern52" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PSTHM.kernels.Isotropy" title="PSTHM.kernels.Isotropy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Isotropy</span></code></a></p>
<p>Implementation of Matern52 kernel:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(k(x,z)=\sigma^2\left(1+\sqrt{5}\times\frac{|x-z|}{l}+\frac{5}{3}\times
\frac{|x-z|^2}{l^2}\right)\exp\left(-\sqrt{5} \times \frac{|x-z|}{l}\right).\)</span></p>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.Matern52.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Matern52.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Matern52.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.Matern52.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.Matern52.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.Periodic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">Periodic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Periodic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Periodic" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Kernel</span></code></p>
<p>Implementation of Periodic kernel:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(k(x,z)=\sigma^2\exp\left(-2\times\frac{\sin^2(\pi(x-z)/p)}{l^2}\right),\)</span></p>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(p\)</span> is the <code class="docutils literal notranslate"><span class="pre">period</span></code> parameter.</p>
<p>References:</p>
<p>[1] <cite>Introduction to Gaussian processes</cite>,
David J.C. MacKay</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lengthscale</strong> (<em>torch.Tensor</em>) – Length scale parameter of this kernel.</p></li>
<li><p><strong>period</strong> (<em>torch.Tensor</em>) – Period parameter of this kernel.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.Periodic.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Periodic.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Periodic.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.Periodic.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.Periodic.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.Polynomial">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">Polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Polynomial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Polynomial" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PSTHM.kernels.DotProduct" title="PSTHM.kernels.DotProduct"><code class="xref py py-class docutils literal notranslate"><span class="pre">DotProduct</span></code></a></p>
<p>Implementation of Polynomial kernel:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(k(x, z) = \sigma^2(\text{bias} + x \cdot z)^d.\)</span></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bias</strong> (<em>torch.Tensor</em>) – Bias parameter of this kernel. Should be positive.</p></li>
<li><p><strong>degree</strong> (<em>int</em>) – Degree <span class="math notranslate nohighlight">\(d\)</span> of the polynomial.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.Polynomial.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Polynomial.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Polynomial.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.Polynomial.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.Polynomial.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.Product">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">Product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kern0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kern1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Product"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Product" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PSTHM.kernels.Combination" title="PSTHM.kernels.Combination"><code class="xref py py-class docutils literal notranslate"><span class="pre">Combination</span></code></a></p>
<p>Returns a new kernel which acts like a product/tensor product of two kernels.
The second kernel can be a constant.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.Product.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Product.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Product.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.Product.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.Product.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.RBF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">RBF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#RBF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.RBF" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PSTHM.kernels.Isotropy" title="PSTHM.kernels.Isotropy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Isotropy</span></code></a></p>
<p>Implementation of Radial Basis Function kernel:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(k(x,z) = \sigma^2\exp\left(-0.5 \times \frac{|x-z|^2}{l^2}\right).\)</span></p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel also has name <cite>Squared Exponential</cite> in literature.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.RBF.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#RBF.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.RBF.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.RBF.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.RBF.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.RationalQuadratic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">RationalQuadratic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_mixture</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#RationalQuadratic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.RationalQuadratic" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PSTHM.kernels.Isotropy" title="PSTHM.kernels.Isotropy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Isotropy</span></code></a></p>
<p>Implementation of RationalQuadratic kernel:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(k(x, z) = \sigma^2 \left(1 + 0.5 \times \frac{|x-z|^2}{\alpha l^2}
\right)^{-\alpha}.\)</span></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scale_mixture</strong> (<em>torch.Tensor</em>) – Scale mixture (<span class="math notranslate nohighlight">\(\alpha\)</span>) parameter of this
kernel. Should have size 1.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.RationalQuadratic.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#RationalQuadratic.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.RationalQuadratic.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.RationalQuadratic.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.RationalQuadratic.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.Sampling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">Sampling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ensemble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Sampling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Sampling" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Kernel</span></code></p>
<p>Implementation of a sampling kernel where the input is a physical model ensemble,
and the kernel is the sampling covariance matrix of the ensemble. It includes a temporal gaussian tamper function, 
to use it, user need to define taper length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> (<em>int</em>) – Dimension of input vectors.</p></li>
<li><p><strong>model_ensemble</strong> (<em>list</em>) – A list of callable models that make up the ensemble.</p></li>
<li><p><strong>weights</strong> (<em>np.ndarray</em>) – Optional weights for each model in the ensemble.</p></li>
<li><p><strong>active_dims</strong> (<em>list</em>) – Indices of active dimensions.</p></li>
<li><p><strong>tau</strong> (<em>int</em>) – temporal value for temporl gaussian taper function</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.Sampling.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Sampling.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Sampling.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.Sampling.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.Sampling.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.Sum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">Sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kern0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kern1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Sum" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PSTHM.kernels.Combination" title="PSTHM.kernels.Combination"><code class="xref py py-class docutils literal notranslate"><span class="pre">Combination</span></code></a></p>
<p>Returns a new kernel which acts like a sum/direct sum of two kernels.
The second kernel can be a constant.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.Sum.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#Sum.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.Sum.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.Sum.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.Sum.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.WhiteNoise">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">WhiteNoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#WhiteNoise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.WhiteNoise" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Kernel</span></code></p>
<p>Implementation of WhiteNoise kernel:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(k(x, z) = \sigma^2 \delta(x, z),\)</span></p>
</div></blockquote>
<p>where <span class="math notranslate nohighlight">\(\delta\)</span> is a Dirac delta function.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.WhiteNoise.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#WhiteNoise.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.WhiteNoise.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.WhiteNoise.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.WhiteNoise.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.kernels.WhiteNoise_SP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">WhiteNoise_SP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_lengthscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#WhiteNoise_SP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.WhiteNoise_SP" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PSTHM.kernels.Isotropy" title="PSTHM.kernels.Isotropy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Isotropy</span></code></a></p>
<p>Implementation of WhiteNoise kernel with multiple choices of spatial and temporal correlation:</p>
<p>if geo==True, then the kernel is spatially uncorrelated
if geo==False, then the kernel is a whiet noise kernel</p>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.kernels.WhiteNoise_SP.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#WhiteNoise_SP.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.WhiteNoise_SP.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.kernels.WhiteNoise_SP.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.kernels.WhiteNoise_SP.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.kernels.check_geo_dim">
<span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">check_geo_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#check_geo_dim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.check_geo_dim" title="Link to this definition">¶</a></dt>
<dd><p>A function to check if the dimension of X is correct.</p>
<p>——-Inputs——-
X: PyTorch tensor input for Gaussian Process</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.kernels.check_pseudo">
<span class="sig-prename descclassname"><span class="pre">PSTHM.kernels.</span></span><span class="sig-name descname"><span class="pre">check_pseudo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/kernels.html#check_pseudo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.kernels.check_pseudo" title="Link to this definition">¶</a></dt>
<dd><p>A function to make sure there’s no correlation between pseudo data and real data.</p>
</dd></dl>

</section>
<section id="module-PSTHM.load">
<span id="psthm-load-module"></span><h3>PSTHM.load module<a class="headerlink" href="#module-PSTHM.load" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.load.load_PSMSL_data">
<span class="sig-prename descclassname"><span class="pre">PSTHM.load.</span></span><span class="sig-name descname"><span class="pre">load_PSMSL_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_lat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_lon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-90</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_time_span</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latest_age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/load.html#load_PSMSL_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.load.load_PSMSL_data" title="Link to this definition">¶</a></dt>
<dd><p>A function to load annual sea-level data from PSMSL (<a class="reference external" href="https://psmsl.org/">https://psmsl.org/</a>), note the site file should be copy and pasted into the data folder.
We have filtered out data with -99999 value, missing data (with ‘Y’ indicated) or any flagged data (i.e., the fourth column is not 0).
———Inputs———
data_folder: str, the path to the data folder
min_lat: float, the minimum latitude of the region of interest
max_lat: float, the maximum latitude of the region of interest
min_lon: float, the minimum longitude of the region of interest
max_lon: float, the maximum longitude of the region of interest</p>
<p>———Outputs———
US_AT_data: a list containing US Atlantic coast data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.load.load_local_rsl_data">
<span class="sig-prename descclassname"><span class="pre">PSTHM.load.</span></span><span class="sig-name descname"><span class="pre">load_local_rsl_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/load.html#load_local_rsl_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.load.load_local_rsl_data" title="Link to this definition">¶</a></dt>
<dd><p>A function to load rsl data from a csv file, this csv 
file should be presented in the same format as NJ_CC.csv in data folder</p>
<p>———Inputs———
file: str, the path to the csv file</p>
<p>———Outputs———
X: torch.tensor, the age of rsl data
y: torch.tensor, the rsl data
y_sigma: torch.tensor, one sigma uncertainty of rsl data
x_sigma: torch.tensor, one uncertainty of age data</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.load.load_regional_rsl_data">
<span class="sig-prename descclassname"><span class="pre">PSTHM.load.</span></span><span class="sig-name descname"><span class="pre">load_regional_rsl_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CE</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/load.html#load_regional_rsl_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.load.load_regional_rsl_data" title="Link to this definition">¶</a></dt>
<dd><p>A function to load rsl data from a csv file, this csv 
file should be presented in the same format as US_Atlantic_Coast_for_ESTGP.csv in data folder</p>
<p>———Inputs———
file: str, the path to the csv file</p>
<p>———Outputs———
marine_limiting: a list containing marine limiting data (details below)
SLIP: a list containing sea-level index point data
terrestrial limiting: a list containing terrestrial limiting data</p>
<p>data within each list:
X: torch.tensor, the age of rsl data
y: torch.tensor, the rsl data
y_sigma: torch.tensor, one sigma uncertainty of rsl data
x_sigma: torch.tensor, one uncertainty of age data
lon: numpy.array, 
rsl_region: a number indicating the region where data locates at</p>
</dd></dl>

</section>
<section id="module-PSTHM.model">
<span id="psthm-model-module"></span><h3>PSTHM.model module<a class="headerlink" href="#module-PSTHM.model" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.model.GIA_ensemble">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.model.</span></span><span class="sig-name descname"><span class="pre">GIA_ensemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">GIA_model_interp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/model.html#GIA_ensemble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.model.GIA_ensemble" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Kernel</span></code></p>
<p>This is a class to define a GIA ensemble model as the mean function for GP</p>
<p>————Inputs————–
GIA_model_interp: a list of interpolation function that can 3D interpolate the
RSL history predicted by a GIA model</p>
<p>————Outputs————–
mean: the prediction of the GIA ensemble model</p>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.model.GIA_ensemble.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/model.html#GIA_ensemble.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.model.GIA_ensemble.forward" title="Link to this definition">¶</a></dt>
<dd><p>Calculates covariance matrix of inputs on active dimensionals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A 2D tensor with shape <span class="math notranslate nohighlight">\(N \times input\_dim\)</span>.</p></li>
<li><p><strong>Z</strong> (<em>torch.Tensor</em>) – An (optional) 2D tensor with shape
<span class="math notranslate nohighlight">\(M \times input\_dim\)</span>.</p></li>
<li><p><strong>diag</strong> (<em>bool</em>) – A flag to decide if we want to return full covariance matrix
or just its diagonal part.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>covariance matrix of <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> with shape
<span class="math notranslate nohighlight">\(N \times M\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.model.GIA_ensemble.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.model.GIA_ensemble.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.model.GPRegression_EIV">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.model.</span></span><span class="sig-name descname"><span class="pre">GPRegression_EIV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/model.html#GPRegression_EIV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.model.GPRegression_EIV" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GPModel</span></code></p>
<p>Gaussian Process Regression model.</p>
<p>The core of a Gaussian Process is a covariance function <span class="math notranslate nohighlight">\(k\)</span> which governs
the similarity between input points. Given <span class="math notranslate nohighlight">\(k\)</span>, we can establish a
distribution over functions <span class="math notranslate nohighlight">\(f\)</span> by a multivarite normal distribution</p>
<div class="math notranslate nohighlight">
\[p(f(X)) = \mathcal{N}(0, k(X, X)),\]</div>
<p>where <span class="math notranslate nohighlight">\(X\)</span> is any set of input points and <span class="math notranslate nohighlight">\(k(X, X)\)</span> is a covariance
matrix whose entries are outputs <span class="math notranslate nohighlight">\(k(x, z)\)</span> of <span class="math notranslate nohighlight">\(k\)</span> over input pairs
<span class="math notranslate nohighlight">\((x, z)\)</span>. This distribution is usually denoted by</p>
<div class="math notranslate nohighlight">
\[f \sim \mathcal{GP}(0, k).\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Generally, beside a covariance matrix <span class="math notranslate nohighlight">\(k\)</span>, a Gaussian Process can
also be specified by a mean function <span class="math notranslate nohighlight">\(m\)</span> (which is a zero-value function
by default). In that case, its distribution will be</p>
<div class="math notranslate nohighlight">
\[p(f(X)) = \mathcal{N}(m(X), k(X, X)).\]</div>
</div>
<p>Given inputs <span class="math notranslate nohighlight">\(X\)</span> and their noisy observations <span class="math notranslate nohighlight">\(y\)</span>, the Gaussian Process
Regression model takes the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}f &amp;\sim \mathcal{GP}(0, k(X, X)),\\
y &amp; \sim f + \epsilon,\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\epsilon\)</span> is Gaussian noise.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This model has <span class="math notranslate nohighlight">\(\mathcal{O}(N^3)\)</span> complexity for training,
<span class="math notranslate nohighlight">\(\mathcal{O}(N^3)\)</span> complexity for testing. Here, <span class="math notranslate nohighlight">\(N\)</span> is the number
of train inputs.</p>
</div>
<p>Reference:</p>
<p>[1] <cite>Gaussian Processes for Machine Learning</cite>,
Carl E. Rasmussen, Christopher K. I. Williams</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A input data for training. Its first dimension is the number
of data points.</p></li>
<li><p><strong>y</strong> (<em>torch.Tensor</em>) – An output data for training. Its last dimension is the
number of data points.</p></li>
<li><p><strong>kernel</strong> (<em>Kernel</em>) – A Pyro kernel object, which
is the covariance function <span class="math notranslate nohighlight">\(k\)</span>.</p></li>
<li><p><strong>x_noise</strong> – A input data for training. Its first dimension is the number, representing 
the variance of the error for age, which is usually obtained from radiocarbon dating</p></li>
<li><p><strong>noise</strong> (<em>torch.Tensor</em>) – Variance of Gaussian noise of this model.</p></li>
<li><p><strong>mean_function</strong> (<em>callable</em>) – An optional mean function <span class="math notranslate nohighlight">\(m\)</span> of this Gaussian
process. By default, we use zero mean.</p></li>
<li><p><strong>jitter</strong> (<em>float</em>) – A small positive term which is added into the diagonal part of
a covariance matrix to help stablize its Cholesky decomposition.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.model.GPRegression_EIV.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noiseless</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/model.html#GPRegression_EIV.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.model.GPRegression_EIV.forward" title="Link to this definition">¶</a></dt>
<dd><p>Computes the mean and covariance matrix (or variance) of Gaussian Process
posterior on a test input data <span class="math notranslate nohighlight">\(X_{new}\)</span>:</p>
<div class="math notranslate nohighlight">
\[p(f^* \mid X_{new}, X, y, k, \epsilon) = \mathcal{N}(loc, cov).\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The noise parameter <code class="docutils literal notranslate"><span class="pre">noise</span></code> (<span class="math notranslate nohighlight">\(\epsilon\)</span>) together with
kernel’s parameters have been learned from a training procedure (MCMC or
SVI).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Xnew</strong> (<em>torch.Tensor</em>) – A input data for testing. Note that
<code class="docutils literal notranslate"><span class="pre">Xnew.shape[1:]</span></code> must be the same as <code class="docutils literal notranslate"><span class="pre">self.X.shape[1:]</span></code>.</p></li>
<li><p><strong>full_cov</strong> (<em>bool</em>) – A flag to decide if we want to predict full covariance
matrix or just variance.</p></li>
<li><p><strong>noiseless</strong> (<em>bool</em>) – A flag to decide if we want to include noise in the
prediction output or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>loc and covariance matrix (or variance) of <span class="math notranslate nohighlight">\(p(f^*(X_{new}))\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple(torch.Tensor, torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.model.GPRegression_EIV.guide">
<span class="sig-name descname"><span class="pre">guide</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/model.html#GPRegression_EIV.guide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.model.GPRegression_EIV.guide" title="Link to this definition">¶</a></dt>
<dd><p>A “guide” stochastic function to be used in variational inference methods. It
also gives posterior information to the method <a class="reference internal" href="#PSTHM.model.GPRegression_EIV.forward" title="PSTHM.model.GPRegression_EIV.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a> for prediction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.model.GPRegression_EIV.model">
<span class="sig-name descname"><span class="pre">model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/model.html#GPRegression_EIV.model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.model.GPRegression_EIV.model" title="Link to this definition">¶</a></dt>
<dd><p>A “model” stochastic function. If <code class="docutils literal notranslate"><span class="pre">self.y</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, this method returns
mean and variance of the Gaussian Process prior.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.model.GPRegression_EIV.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.model.GPRegression_EIV.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PSTHM.model.GPRegression_V">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PSTHM.model.</span></span><span class="sig-name descname"><span class="pre">GPRegression_V</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/model.html#GPRegression_V"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.model.GPRegression_V" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GPModel</span></code></p>
<p>Gaussian Process Regression model.</p>
<p>The core of a Gaussian Process is a covariance function <span class="math notranslate nohighlight">\(k\)</span> which governs
the similarity between input points. Given <span class="math notranslate nohighlight">\(k\)</span>, we can establish a
distribution over functions <span class="math notranslate nohighlight">\(f\)</span> by a multivarite normal distribution</p>
<div class="math notranslate nohighlight">
\[p(f(X)) = \mathcal{N}(0, k(X, X)),\]</div>
<p>where <span class="math notranslate nohighlight">\(X\)</span> is any set of input points and <span class="math notranslate nohighlight">\(k(X, X)\)</span> is a covariance
matrix whose entries are outputs <span class="math notranslate nohighlight">\(k(x, z)\)</span> of <span class="math notranslate nohighlight">\(k\)</span> over input pairs
<span class="math notranslate nohighlight">\((x, z)\)</span>. This distribution is usually denoted by</p>
<div class="math notranslate nohighlight">
\[f \sim \mathcal{GP}(0, k).\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Generally, beside a covariance matrix <span class="math notranslate nohighlight">\(k\)</span>, a Gaussian Process can
also be specified by a mean function <span class="math notranslate nohighlight">\(m\)</span> (which is a zero-value function
by default). In that case, its distribution will be</p>
<div class="math notranslate nohighlight">
\[p(f(X)) = \mathcal{N}(m(X), k(X, X)).\]</div>
</div>
<p>Given inputs <span class="math notranslate nohighlight">\(X\)</span> and their noisy observations <span class="math notranslate nohighlight">\(y\)</span>, the Gaussian Process
Regression model takes the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}f &amp;\sim \mathcal{GP}(0, k(X, X)),\\
y &amp; \sim f + \epsilon,\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\epsilon\)</span> is Gaussian noise.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This model has <span class="math notranslate nohighlight">\(\mathcal{O}(N^3)\)</span> complexity for training,
<span class="math notranslate nohighlight">\(\mathcal{O}(N^3)\)</span> complexity for testing. Here, <span class="math notranslate nohighlight">\(N\)</span> is the number
of train inputs.</p>
</div>
<p>Reference:</p>
<p>[1] <cite>Gaussian Processes for Machine Learning</cite>,
Carl E. Rasmussen, Christopher K. I. Williams</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>torch.Tensor</em>) – A input data for training. Its first dimension is the number
of data points.</p></li>
<li><p><strong>y</strong> (<em>torch.Tensor</em>) – An output data for training. Its last dimension is the
number of data points.</p></li>
<li><p><strong>kernel</strong> (<em>Kernel</em>) – A Pyro kernel object, which
is the covariance function <span class="math notranslate nohighlight">\(k\)</span>.</p></li>
<li><p><strong>noise</strong> (<em>torch.Tensor</em>) – Variance of Gaussian noise of this model.</p></li>
<li><p><strong>mean_function</strong> (<em>callable</em>) – An optional mean function <span class="math notranslate nohighlight">\(m\)</span> of this Gaussian
process. By default, we use zero mean.</p></li>
<li><p><strong>jitter</strong> (<em>float</em>) – A small positive term which is added into the diagonal part of
a covariance matrix to help stablize its Cholesky decomposition.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.model.GPRegression_V.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/model.html#GPRegression_V.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.model.GPRegression_V.forward" title="Link to this definition">¶</a></dt>
<dd><p>Computes the mean and covariance matrix (or variance) of Gaussian Process
posterior on a test input data <span class="math notranslate nohighlight">\(X_{new}\)</span>:</p>
<div class="math notranslate nohighlight">
\[p(f^* \mid X_{new}, X, y, k, \epsilon) = \mathcal{N}(loc, cov).\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The noise parameter <code class="docutils literal notranslate"><span class="pre">noise</span></code> (<span class="math notranslate nohighlight">\(\epsilon\)</span>) together with
kernel’s parameters have been learned from a training procedure (MCMC or
SVI).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Xnew</strong> (<em>torch.Tensor</em>) – A input data for testing. Note that
<code class="docutils literal notranslate"><span class="pre">Xnew.shape[1:]</span></code> must be the same as <code class="docutils literal notranslate"><span class="pre">self.X.shape[1:]</span></code>.</p></li>
<li><p><strong>full_cov</strong> (<em>bool</em>) – A flag to decide if we want to predict full covariance
matrix or just variance.</p></li>
<li><p><strong>noiseless</strong> (<em>bool</em>) – A flag to decide if we want to include noise in the
prediction output or notest_cov[i:i+1]t.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>loc and covariance matrix (or variance) of <span class="math notranslate nohighlight">\(p(f^*(X_{new}))\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple(torch.Tensor, torch.Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.model.GPRegression_V.guide">
<span class="sig-name descname"><span class="pre">guide</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/model.html#GPRegression_V.guide"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.model.GPRegression_V.guide" title="Link to this definition">¶</a></dt>
<dd><p>A “guide” stochastic function to be used in variational inference methods. It
also gives posterior information to the method <a class="reference internal" href="#PSTHM.model.GPRegression_V.forward" title="PSTHM.model.GPRegression_V.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a> for prediction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PSTHM.model.GPRegression_V.model">
<span class="sig-name descname"><span class="pre">model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/model.html#GPRegression_V.model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.model.GPRegression_V.model" title="Link to this definition">¶</a></dt>
<dd><p>A “model” stochastic function. If <code class="docutils literal notranslate"><span class="pre">self.y</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, this method returns
mean and variance of the Gaussian Process prior.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PSTHM.model.GPRegression_V.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#PSTHM.model.GPRegression_V.training" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.model.change_point_model">
<span class="sig-prename descclassname"><span class="pre">PSTHM.model.</span></span><span class="sig-name descname"><span class="pre">change_point_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intercept_prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficient_prior</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/model.html#change_point_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.model.change_point_model" title="Link to this definition">¶</a></dt>
<dd><p>A function to define a change-point model in pyro</p>
<p>————Inputs————–
X: 2D torch tensor with shape (n_samples,n_features)
y: 1D torch tensor with shape (n_samples)
x_sigma: float, standard deviation of the error for age, which is obtained from the age data model
y_sigma: float, standard deviation or covariance function of the error for the RSL, which is obtained from the RSL data model
n_cp: int, number of change-points
intercept_prior: pyro distribution for the intercept coefficient
coefficient_prior: pyro distribution for the slope coefficient</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.model.ensemble_GIA_model">
<span class="sig-prename descclassname"><span class="pre">PSTHM.model.</span></span><span class="sig-name descname"><span class="pre">ensemble_GIA_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ensemble</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_age</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/model.html#ensemble_GIA_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.model.ensemble_GIA_model" title="Link to this definition">¶</a></dt>
<dd><p>A function to define a linear model in pyro</p>
<p>————Inputs————–
X: 2D torch tensor with shape (n_samples,n_features)
y: 1D torch tensor with shape (n_samples)
x_sigma: float, standard deviation of the error for age, which is obtained from the age data model
y_sigma: float, standard deviation or covariance function of the error for the RSL, which is obtained from the RSL data model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.model.linear_model">
<span class="sig-prename descclassname"><span class="pre">PSTHM.model.</span></span><span class="sig-name descname"><span class="pre">linear_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intercept_prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficient_prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whitenoise_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/model.html#linear_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.model.linear_model" title="Link to this definition">¶</a></dt>
<dd><p>A function to define a linear model in pyro</p>
<p>————Inputs————–
X: 2D torch tensor with shape (n_samples,n_features)
y: 1D torch tensor with shape (n_samples)
x_sigma: float, standard deviation of the error for age, which is obtained from the age data model
y_sigma: float, standard deviation or covariance function of the error for the RSL, which is obtained from the RSL data model
intercept_prior: pyro distribution for the intercept coefficient
coefficient_prior: pyro distribution for the slope coefficient
whitenoise_prior: pyro distribution for the white noise</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.model.linear_model_uniform">
<span class="sig-prename descclassname"><span class="pre">PSTHM.model.</span></span><span class="sig-name descname"><span class="pre">linear_model_uniform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intercept_prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficient_prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">whitenoise_prior</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/model.html#linear_model_uniform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.model.linear_model_uniform" title="Link to this definition">¶</a></dt>
<dd><p>A function to define a linear model with uniform likelihood in pyro</p>
<p>————Inputs————–
X: 2D torch tensor with shape (n_samples,n_features)
y: 1D torch tensor with shape (n_samples), note y is the middle point of the paleo RSL range
x_sigma: float, standard deviation of the error for age, which is obtained from the age data model
y_range: float, upper and lower bound of the error for the paleo RSL, which is defined by different types of coral
intercept_prior: pyro distribution for the intercept coefficient
coefficient_prior: pyro distribution for the slope coefficient</p>
</dd></dl>

</section>
<section id="module-PSTHM.opti">
<span id="psthm-opti-module"></span><h3>PSTHM.opti module<a class="headerlink" href="#module-PSTHM.opti" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.opti.HMC_mcmc">
<span class="sig-prename descclassname"><span class="pre">PSTHM.opti.</span></span><span class="sig-name descname"><span class="pre">HMC_mcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gpr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_accept_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/opti.html#HMC_mcmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.opti.HMC_mcmc" title="Link to this definition">¶</a></dt>
<dd><p>A function to run Hamiltonian Monte Carlo for GP regression model</p>
<p>———-Inputs———
gpr: a pyro GP regression model
num_samples: number of samples to draw from the posterior
warmup_steps: number of warmup steps for NUTS
target_accept_prob: target acceptance probability for NUTS
print_stats: whether to print the states of the model</p>
<p>———-Outputs———
mcmc: a pyro MCMC object</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.opti.NUTS_mcmc">
<span class="sig-prename descclassname"><span class="pre">PSTHM.opti.</span></span><span class="sig-name descname"><span class="pre">NUTS_mcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gpr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_accept_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/opti.html#NUTS_mcmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.opti.NUTS_mcmc" title="Link to this definition">¶</a></dt>
<dd><p>A function to run NUTS MCMC for GP regression model</p>
<p>———-Inputs———
gpr: a pyro GP regression model
num_samples: number of samples to draw from the posterior
warmup_steps: number of warmup steps for NUTS
target_accept_prob: target acceptance probability for NUTS
print_stats: whether to print the states of the model</p>
<p>———-Outputs———
mcmc: a pyro MCMC object</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.opti.SVI_NI_optm">
<span class="sig-prename descclassname"><span class="pre">PSTHM.opti.</span></span><span class="sig-name descname"><span class="pre">SVI_NI_optm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gpr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_kernels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/opti.html#SVI_NI_optm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.opti.SVI_NI_optm" title="Link to this definition">¶</a></dt>
<dd><p>A funciton to optimize the hyperparameters of a GP model using SVI</p>
<p>———Inputs———–
gpr: a GP model defined by pyro GPR regression
x_sigma: one sigma uncertainty for input data
num_iteration: number of iterations for the optimization
lr: learning rate for the optimization
step_size: step size for the learning rate to decay. 
decay_r: decay rate for the learning rate
A step size of 100 with a decay rate of 0.9 means that the learning rate will be decrease 10% for every 100 steps.
equal_kernels: a list of list of kernels that will be set to have the same hyperparameter. For example, if we want to use
the same lengthscale for global kernel and regional non-linear kernel, you can set  equal_kernels = [[‘gpr.kern0.kern0.kern0.lengthscale’,’gpr.kern0.kern1.lengthscale‘]].
This also supports multiple kernel pairs.</p>
<p>gpu: whether use gpu to accelerate training 
———Outputs———–
gpr: a GP model with optimized hyperparameters
track: a dictionary of loss</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.opti.SVI_optm">
<span class="sig-prename descclassname"><span class="pre">PSTHM.opti.</span></span><span class="sig-name descname"><span class="pre">SVI_optm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gpr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_kernels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/opti.html#SVI_optm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.opti.SVI_optm" title="Link to this definition">¶</a></dt>
<dd><p>A funciton to optimize the hyperparameters of a GP model using SVI</p>
<p>———Inputs———–
gpr: a GP model defined by pyro GPR regression
num_iteration: number of iterations for the optimization
lr: learning rate for the optimization
decay_r: decay rate for the learning rate
step_size: step size for the learning rate to decay. 
A step size of 100 with a decay rate of 0.9 means that the learning rate will be decrease 10% for every 100 steps.
equal_kernels: a list of list of kernels that will be set to have the same hyperparameter. For example, if we want to use
the same lengthscale for global kernel and regional non-linear kernel, you can set  equal_kernels = [[‘gpr.kern0.kern0.kern0.lengthscale’,’gpr.kern0.kern1.lengthscale‘]].
This also supports multiple kernel pairs.</p>
<p>———Outputs———–
gpr: a GP model with optimized hyperparameters
track: a dictionary of loss</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.opti.mcmc_pyro_model">
<span class="sig-prename descclassname"><span class="pre">PSTHM.opti.</span></span><span class="sig-name descname"><span class="pre">mcmc_pyro_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_paras</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_accept_prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/opti.html#mcmc_pyro_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.opti.mcmc_pyro_model" title="Link to this definition">¶</a></dt>
<dd><p>A function to run MCMC model in Pyro</p>
<p>————Inputs————–
model: pyro model
model_paras: dictionary, the parameters of the model
num_samples: int, number of samples to draw
warmup_steps: int, number of warmup steps
target_accept_prob: float, target acceptance probability
print_stats: bool, whether to print the statistics of the model</p>
<p>————Outputs————–
hmc_samples: dictionary, the samples of the model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.opti.opti_pyro_model">
<span class="sig-prename descclassname"><span class="pre">PSTHM.opti.</span></span><span class="sig-name descname"><span class="pre">opti_pyro_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_sigma</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/opti.html#opti_pyro_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.opti.opti_pyro_model" title="Link to this definition">¶</a></dt>
<dd><p>A function to optimize the pyro model</p>
<p>Parameters:
model: function, the model function to be optimized
X: torch.Tensor, the input features
y: torch.Tensor, the target variable
x_sigma: float, standard deviation of the input features’ error
y_sigma: float, standard deviation of the target variable’s error
<a href="#id1"><span class="problematic" id="id2">*</span></a>args: additional arguments for the model
lr: float, initial learning rate
number_of_steps: int, total number of optimization steps
step_size: int, the number of steps after which the learning rate will decay
decay_r: float, the decay rate by which the learning rate will be multiplied</p>
<p>Returns:
guide: the optimized guide corresponding to the model
losses: list of loss values during training</p>
</dd></dl>

</section>
<section id="module-PSTHM.plotting">
<span id="psthm-plotting-module"></span><h3>PSTHM.plotting module<a class="headerlink" href="#module-PSTHM.plotting" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.plotting.plot_loss">
<span class="sig-prename descclassname"><span class="pre">PSTHM.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/plotting.html#plot_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.plotting.plot_loss" title="Link to this definition">¶</a></dt>
<dd><p>A function used to plot loss function variation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.plotting.plot_spatial_rsl_range">
<span class="sig-prename descclassname"><span class="pre">PSTHM.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_spatial_rsl_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsl_lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsl_lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsl_age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsl_region</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_site</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/plotting.html#plot_spatial_rsl_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.plotting.plot_spatial_rsl_range" title="Link to this definition">¶</a></dt>
<dd><p>A function to plot the spatial mean RSL, RSL change rate and RSL uncertainty maps</p>
<p>——–Inputs——–
pred_matrix: a matrix with 3 columns, the first column is the age, the second column is the latitude, the third column is the longitude
y_mean: the mean of the predicted RSL from GP model
y_var: the covariance matrix of the predicted RSL from GP model
rsl_lon: the longitude of the RSL data
rsl_lat: the latitude of the RSL data
rsl_age: the age of the RSL data
rsl_region: the region of the RSL data
cmap: the colormap used in the plot</p>
<p>——–Outputs——–
A figure with three subplots, the left subplot is the mean RSL map, the middle subplot is the RSL change rate map,
the right subplot is the RSL uncertainty map</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.plotting.plot_spatial_rsl_single">
<span class="sig-prename descclassname"><span class="pre">PSTHM.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_spatial_rsl_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pred_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'viridis'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/plotting.html#plot_spatial_rsl_single"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.plotting.plot_spatial_rsl_single" title="Link to this definition">¶</a></dt>
<dd><p>A function to plot the spatial RSL map and uncertainty map</p>
<p>——Inputs——
pred_matrix: a matrix with 3 columns, the first column is the age, the second column is the latitude, the third column is the longitude
y_mean: the mean of the predicted RSL
y_var: the covariance matrix of the predicted RSL</p>
<p>——Outputs——
A figure with two subplots, the left subplot is the RSL map, the right subplot is the RSL uncertainty map</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.plotting.plot_tem_regression">
<span class="sig-prename descclassname"><span class="pre">PSTHM.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_tem_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_rsl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_age_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_rsl_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_rsl_age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_rsl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsl_sd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsl_rate_age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate_sd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/plotting.html#plot_tem_regression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.plotting.plot_tem_regression" title="Link to this definition">¶</a></dt>
<dd><p>A function to create matplotlib plot for temporal regression results.</p>
<p>—————–Inputs——————-
data_age: a 1-D array of rsl age data
data_rsl: a 1-D array of rsl data
data_age_sigma: a 1-D array containing 1 sigma uncertainty of rsl age data
data_rsl_sigma: a 1-D array containing 1 sigma uncertainty of rsl data
mean_rsl_age: a 1-D array of testing age data, i.e., new_X for GP regression
mean_rsl: a 1-D array of mean rsl regression results
rsl_sd: a 1-D array of rsl regression standard deviation
rsl_rate_age: a 1-D array of testing age data for rsl rate
rsd_rate: a 1-D array of mean rsl rate regression results
rate_sd: a 1-D array of rsl rate regression standard deviation
axes: matplotlib axes, if None, create a new figure
save: bool, whether to save the plot</p>
<p>—————Output——————-
A matplotlib plot of temporal regression results which contains
three sub-plots: 1) RSL data with uncertainty box and mean regression line; 2) RSL rate
with uncertainty box and mean regression line; 3) Residual plot.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.plotting.plot_track_list">
<span class="sig-prename descclassname"><span class="pre">PSTHM.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_track_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">track_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/plotting.html#plot_track_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.plotting.plot_track_list" title="Link to this definition">¶</a></dt>
<dd><p>A function to plot the track_list generated from SVI_optm function</p>
<p>——Inputs——
track_list: a dictionary containing the name and values of tracking variables</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.plotting.plot_uncertainty_boxes">
<span class="sig-prename descclassname"><span class="pre">PSTHM.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_uncertainty_boxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CE</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/plotting.html#plot_uncertainty_boxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.plotting.plot_uncertainty_boxes" title="Link to this definition">¶</a></dt>
<dd><p>A function to plot uncertainty box for data with vertical and horizontal uncertainties.</p>
<p>—————–Input——————-
x: a 1-D array of input data
y: a 1-D array of ouput data
x_error: a 1-D array containing 2 sigma uncertainty of input data
y_error: a 1-D array containing 2 sigma uncertainty of output data</p>
<p>—————Return——————-
ax: a matplotlib ax of output plot</p>
</dd></dl>

</section>
<section id="module-PSTHM.post">
<span id="psthm-post-module"></span><h3>PSTHM.post module<a class="headerlink" href="#module-PSTHM.post" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.post.cal_MSE">
<span class="sig-prename descclassname"><span class="pre">PSTHM.post.</span></span><span class="sig-name descname"><span class="pre">cal_MSE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yhat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/post.html#cal_MSE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.post.cal_MSE" title="Link to this definition">¶</a></dt>
<dd><p>A function to calculate MSE coefficient</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.post.cal_geo_dist2">
<span class="sig-prename descclassname"><span class="pre">PSTHM.post.</span></span><span class="sig-name descname"><span class="pre">cal_geo_dist2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/post.html#cal_geo_dist2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.post.cal_geo_dist2" title="Link to this definition">¶</a></dt>
<dd><p>A function to calculate the squared distance matrix between each pair of X.
The function takes a PyTorch tensor of X and returns a matrix
where matrix[i, j] represents the spatial distance between the i-th and j-th X.</p>
<p>——-Inputs——-
X: PyTorch tensor of shape (n, 2), representing n pairs of (lat, lon) X
R: approximate radius of earth in km</p>
<p>——-Outputs——-
distance_matrix: PyTorch tensor of shape (n, n), representing the distance matrix</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.post.cal_likelihood">
<span class="sig-prename descclassname"><span class="pre">PSTHM.post.</span></span><span class="sig-name descname"><span class="pre">cal_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/post.html#cal_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.post.cal_likelihood" title="Link to this definition">¶</a></dt>
<dd><p>A function used to calcualte log likelihood function for a given prediction.
This calculation only considers uncertainty in y axis.</p>
<p>————Inputs——————
y: reconstructed rsl
y_std: standard deviation of reconstructed rsl
pred: mean predction of rsl</p>
<p>————Outputs——————
likelihood: mean likelihood of prediction fit to observation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.post.cal_misfit">
<span class="sig-prename descclassname"><span class="pre">PSTHM.post.</span></span><span class="sig-name descname"><span class="pre">cal_misfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/post.html#cal_misfit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.post.cal_misfit" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.post.cal_rate_var">
<span class="sig-prename descclassname"><span class="pre">PSTHM.post.</span></span><span class="sig-name descname"><span class="pre">cal_rate_var</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_rsl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">difftimestep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/post.html#cal_rate_var"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.post.cal_rate_var" title="Link to this definition">¶</a></dt>
<dd><p>A function to caluclate standard deviation of sea-levle change rate (i.e., first derivative of 
GP).
——————Inputs—————————-
test_X: an array of test input values
cov_matrix: full covariance matrix from GP regression
mean_rsl: GP regression produced mean RSL prediction
difftimestep: time period for averaging</p>
<p>——————Outputs—————————
difftimes: time series for the outputs
rate: averaged sea-level change rate
rate_sd: averaged sea-level change rate standard deviation</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.post.cal_wMSE">
<span class="sig-prename descclassname"><span class="pre">PSTHM.post.</span></span><span class="sig-name descname"><span class="pre">cal_wMSE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yhat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/post.html#cal_wMSE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.post.cal_wMSE" title="Link to this definition">¶</a></dt>
<dd><p>A function to calculate weighted MSE coefficient</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.post.change_point_forward">
<span class="sig-prename descclassname"><span class="pre">PSTHM.post.</span></span><span class="sig-name descname"><span class="pre">change_point_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cp_loc_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_coef_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/post.html#change_point_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.post.change_point_forward" title="Link to this definition">¶</a></dt>
<dd><p>A function to calculate the forward model of the change-point model</p>
<p>————Inputs————–
n_cp: int, number of change-points
cp_loc_list: 1D torch tensor with shape (n_cp), the location of the change-points
new_X: 2D torch tensor with shape (n_samples,n_features) for new data prediction
data_X: 2D torch tensor with shape (n_samples,n_features) for training data
beta_coef_list: 1D torch tensor with shape (n_cp+1), the slope coefficients
b: float, the intercept coefficient</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.post.decompose_kernels">
<span class="sig-prename descclassname"><span class="pre">PSTHM.post.</span></span><span class="sig-name descname"><span class="pre">decompose_kernels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gpr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/post.html#decompose_kernels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.post.decompose_kernels" title="Link to this definition">¶</a></dt>
<dd><p>A function to calculate different kernels contribution to final prediction</p>
<p>——————Inputs—————————-
gpr: an optimized pyro GP regression model
pred_matrix: a torch tensor of prediction matrix containing the data points for prediction
kernels: a list of pyro kernels for decomposition</p>
<p>——————Outputs—————————
output: a list of tuples, each tuple contains the mean and covariance of the prediction for each kernel</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.post.gen_pred_matrix">
<span class="sig-prename descclassname"><span class="pre">PSTHM.post.</span></span><span class="sig-name descname"><span class="pre">gen_pred_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">age</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/post.html#gen_pred_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.post.gen_pred_matrix" title="Link to this definition">¶</a></dt>
<dd><p>A function to generate an input matrix for Spatio-temporal GP model</p>
<p>———-Inputs—————-
age: a numpy array, age of the prediction points
lat: a numpy array, latitude of the prediction points
lon: a numpy array, longitude of the prediction points</p>
<p>———-Outputs—————-
output_matrix: a torch tensor, input matrix for the spatio-temporal GP model</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PSTHM.post.get_change_point_posterior">
<span class="sig-prename descclassname"><span class="pre">PSTHM.post.</span></span><span class="sig-name descname"><span class="pre">get_change_point_posterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">guide</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_number</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PSTHM/post.html#get_change_point_posterior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PSTHM.post.get_change_point_posterior" title="Link to this definition">¶</a></dt>
<dd><p>Function to sample from the guide and return posterior samples for change point model</p>
<p>———-Inputs———-
guide: pyro model guide
sample_number: int, number of samples to draw from the guide</p>
</dd></dl>

</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table of Contents</a></h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#paleostehm">PaleoSTeHM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-PSTHM.kernels">PSTHM.kernels module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-PSTHM.load">PSTHM.load module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-PSTHM.model">PSTHM.model module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-PSTHM.opti">PSTHM.opti module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-PSTHM.plotting">PSTHM.plotting module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-PSTHM.post">PSTHM.post module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="about.html" title="previous chapter">About</a></li>
      <li>Next: <a href="installation.html" title="next chapter">Installation</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/apidoc.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Yucheng Lin, Alex Reedy, Robert Kopp.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/apidoc.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>